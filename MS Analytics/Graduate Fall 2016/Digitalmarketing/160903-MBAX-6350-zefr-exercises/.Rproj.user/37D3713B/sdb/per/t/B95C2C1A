{
    "collab_server" : "",
    "contents" : "##############\n###MAY NEED TO UPDATE JAVA\n###LOAD PACKAGES\n\ninstall.packages(\"XLConnect\")\nlibrary(XLConnect)\n\ninstall.packages(\"xlsx\")\nlibrary(xlsx)\n\n\n\nrequire(xlsx)\n\n\n\n\n\n\ninstall.packages(\"openxlsx\")\nlibrary(openxlsx)\n\ninstall.packages(\"RColorBrewer\")\nlibrary(RColorBrewer)\n\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\n\n\n\n##################\n\n#Shortcut to call files\n\n#Mac Users- place excel files on desktop\n\nbrands <- c(\"mtdew\", \"reeses\", \"shocktop\", \"snickers\",\"official-channels\" )\ndataFiles <- paste0(\"~/Desktop/\",brands,\".xlsx\")\n\n\n###############\n\nrequire(XLConnect) \n\n#################REESES##################\n\n#load entire workbook per brand\nreeses<- XLConnect::loadWorkbook(dataFiles[2])\n\n\n#loads all data into example: \"mtdew_all\" dataframe.\n\nreeses<- XLConnect::loadWorkbook(dataFiles[2])\n\n\n\n#Label individual tabs based on date\njan.11_reeses <- readWorksheet(reeses, 1) \n\n#call individual tabs at your leisure with cmd below \njan.11_reeses\n\njan.16_reeses <- readWorksheet(reeses, 2) \njan.23_reeses<- readWorksheet(reeses, 3) \njan.30_reeses <- readWorksheet(reeses, 4) \nfeb.06_reeses<- readWorksheet(reeses, 5) \nfeb.13_reeses <- readWorksheet(reeses, 6) \n\n\n#####################################MTDEW#######\n\nmtdew<- XLConnect::loadWorkbook(dataFiles[1])\n\n\njan.11_mtdew <- readWorksheet(mtdew, 1) \n\njan.11_mtdew\njan.16_mtdew <- readWorksheet(mtdew, 2) \njan.23_mtdew<- readWorksheet(mtdew, 3) \njan.30_mtdew <- readWorksheet(mtdew, 4) \nfeb.06_mtdew<- readWorksheet(mtdew, 5) \nfeb.13_mtdew <- readWorksheet(mtdew, 6) \n\n\n\n#############################SHOCKTOP###########\n\nshocktop<- XLConnect::loadWorkbook(dataFiles[3])\n\n\njan.11_shocktop<- readWorksheet(shocktop, 1) \njan.16_shocktop<- readWorksheet(shocktop, 2) \njan.23_shocktop<- readWorksheet(shocktop, 3) \njan.30_shocktop <- readWorksheet(shocktop, 4) \nfeb.06_shocktop<- readWorksheet(shocktop, 5) \nfeb.13_shocktop <- readWorksheet(shocktop, 6) \n\n\n##################SNICKERS##############\n\nsnickers <- read.xlsx(dataFiles[4])\n\njan.11_snickers <- read.xlsx(dataFiles[4], sheet = 1)\njan.16_snickers <- read.xlsx(dataFiles[4], sheet = 2)\njan.23_snickers <- read.xlsx(dataFiles[4], sheet = 3)\njan.30_snickers <- read.xlsx(dataFiles[4], sheet = 4)\nfeb.06_snickers <- read.xlsx(dataFiles[4], sheet = 5)\nfeb.13_snickers <- read.xlsx(dataFiles[4], sheet = 6)\n\n\n\n#load official channels excel workbook\n\nofficialchannels <- read.xlsx(dataFiles[5])\n\n#Check it loaded properly\nofficialchannels\n\n\n#PART 1 Did the views of official brand content rise after the Super Bowl?\n\n\n\n#BELOW WE SUBSET THE SHEETS BY DATE; FILTERED TO ONLY INCLUDE THOSE WITH THE OFFICIAL CHANNEL\n\n#Date Vector\nobservationDates <- (c(\"2016-01-11\",\"2016-01-16\",\"2016-01-23\", \"2016-01-30\", \"2016-02-06\", \"2016-02-13\"))\n\n\n\n#SNICKERS\n\n#Below subsets the data based on the given primary channel\njan.11_snickers_a<-subset( jan.11_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \n#view the subset\njan.11_snickers_a\njan.16_snickers_a<-subset( jan.16_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \njan.23_snickers_a<-subset( jan.23_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \njan.30_snickers_a<-subset( jan.30_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \nfeb.06_snickers_a<-subset( feb.06_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \nfeb.13_snickers_a<-subset( feb.13_snickers, channel_id== \"UCDviI62w0VbD_9oRNkV1Uig\" ) \n\n\n#REESES\njan.11_reeses_a<-subset( jan.11_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \njan.16_reeses_a<-subset( jan.16_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \njan.23_reeses_a<-subset( jan.23_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \njan.30_reeses_a<-subset( jan.30_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \nfeb.06_reeses_a<-subset( feb.06_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \nfeb.13_reeses_a<-subset( feb.13_reeses, channel_id== \"UCc9-kl38p_uzQDVrT06VTxA\" ) \n\nf\n#MTDEW\njan.11_mtdew_a<-subset( jan.11_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \njan.16_mtdew_a<-subset( jan.16_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \njan.23_mtdew_a<-subset( jan.23_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \njan.30_mtdew_a<-subset( jan.30_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \nfeb.06_mtdew_a<-subset( feb.06_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \nfeb.13_mtdew_a<-subset( feb.13_mtdew, channel_id== \"UCsdqpqgsSFTRSnyyqHVSgyw\" ) \n\n\n#SHOCKTOP\njan.11_shocktop_a<-subset( jan.11_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \njan.16_shocktop_a<-subset( jan.16_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \njan.23_shocktop_a<-subset( jan.23_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \njan.30_shocktop_a<-subset( jan.30_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \nfeb.06_shocktop_a<-subset( feb.06_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \nfeb.13_shocktop_a<-subset( feb.13_shocktop, channel_id== \"UCpfUlFZlM1yfcJG5dl9fwyg\" ) \n\n\n#######################GRAPHS###############################\n\n####SHOCKTOP#####\n\n#Sum's the views of shocktop from your newly formed subset containing only those with primary channels\n\n\na<-sum(jan.11_shocktop_a$views)\nb<-sum(jan.16_shocktop_a$views)\nc<-sum(jan.23_shocktop_a$views)\nd<-sum(jan.30_shocktop_a$views)\ne<-sum(feb.06_shocktop_a$views)\nf<-sum(feb.13_shocktop_a$views)\n\n\n#put values intro vector\nshocktop_views_string<-c(a,b,c,d,e,f)\n\n#Create seperate data.frame that combines the observation dates with corresponding view count\n\nshock_frame<-data.frame(cbind(observationDates,shocktop_views_string))\nshock_frame$views1000s<-shocktop_views_string/1000\n\nshock_frame\n\n#sets graph equal too \"ggg\" using ggplot framework\nggg<-ggplot(data=shock_frame, aes(x=observationDates, y=views1000s, fill=observationDates))+geom_bar(stat=\"identity\") + scale_fill_brewer(palette=\"Spectral\")+coord_flip() +ggtitle(\"Official Shock Top Views\")+ xlab(\"Dates\")+ylab(\"View Count ( in Thousands)\")+theme_bw()\n\n\n#view graph\nggg\n\n####MT DEW##### SAME STEPS AS ABOVE...REPEAT\n\ng<-sum(jan.11_mtdew_a$views)\nh<-sum(jan.16_mtdew_a$views)\ni<-sum(jan.23_mtdew_a$views)\nj<-sum(jan.30_mtdew_a$views)\nk<-sum(feb.06_mtdew_a$views)\nl<-sum(feb.13_mtdew_a$views)\n\nmtdew_views_string<-c(g,h,i,j,k,l)\n\ndew_frame<-data.frame(cbind(observationDates,mtdew_views_string))\ndew_frame$views1000s<-mtdew_views_string/1000\n\ndew_frame\n\n\nhhh<-ggplot(data=dew_frame, aes(x=observationDates, y=views1000s, fill=observationDates))+geom_bar(stat=\"identity\") + scale_fill_brewer(palette=\"Spectral\")+coord_flip() +ggtitle(\"Official Mt Dew Views\")+ xlab(\"Dates\")+ylab(\"View Count ( in Thousands)\")+theme_bw()\n\nhhh\n\n\n#####REEESES#####\n\n\nm<-sum(jan.11_reeses_a$views)\nn<-sum(jan.16_reeses_a$views)\no<-sum(jan.23_reeses_a$views)\np<-sum(jan.30_reeses_a$views)\nq<-sum(feb.06_reeses_a$views)\nr<-sum(feb.13_reeses_a$views)\n\nreeses_views_string<-c(m,n,o,p,q,r)\n\nreeses_frame<-data.frame(cbind(observationDates,reeses_views_string))\nreeses_frame$views1000s<-reeses_views_string/1000\n\nreeses_frame\n\n\niii<-ggplot(data=reeses_frame, aes(x=observationDates, y=views1000s, fill=observationDates))+geom_bar(stat=\"identity\") + scale_fill_brewer(palette=\"Spectral\")+coord_flip() +ggtitle(\"Official Reeses Views\")+ xlab(\"Dates\")+ylab(\"View Count ( in Thousands)\")+theme_bw()\n\niii\n\n\n\n###SNICKERS####\n\ns<-sum(jan.11_snickers_a$views)\nt<-sum(jan.16_snickers_a$views)\nu<-sum(jan.23_snickers_a$views)\nv<-sum(jan.30_snickers_a$views)\nw<-sum(feb.06_snickers_a$views)\nx<-sum(feb.13_snickers_a$views)\n\nsnickers_views_string<-c(s,t,u,v,w,x)\n\nsnickers_frame<-data.frame(cbind(observationDates,snickers_views_string))\nsnickers_frame$views1000s<-snickers_views_string/1000\n\nshock_frame\n\n\njjj<-ggplot(data=snickers_frame, aes(x=observationDates, y=views1000s, fill=observationDates))+geom_bar(stat=\"identity\") + scale_fill_brewer(palette=\"Spectral\")+coord_flip() +ggtitle(\"Official Snickers Views\")+ xlab(\"Dates\")+ylab(\"View Count ( in Thousands)\")+theme_bw()\n\n\n",
    "created" : 1475104279812.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "648465876",
    "id" : "B95C2C1A",
    "lastKnownWriteTime" : 1475104151,
    "last_content_update" : 1475104151,
    "path" : "~/Desktop/Fall_2016_Grad_Work/Digital_Marketing_Script.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}